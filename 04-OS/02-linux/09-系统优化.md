# 1. Selinux

## 1.1 作用

selinux主要作用就是最大限度地减小系统中服务进程可访问的资源（最小权限原则)

所以为了使系统最大化运行, 要关闭此操作

## 1.2 操作

```bash
getenforce  #获取selinux状态, Enforcing强制模式, Permissive宽容模式, disabled关闭模式
setenforce 0/1   # 0表示宽容模式  1表示强制模式
```

永久关闭

1. 操作文件

   ```bash
   vim /etc/selinux/config
   ```

   

2. 修改内容

   ```bash
   SELINUX=enforcing
   ```

   为

   ```bash
   SELINUX=disabled
   ```

3. 重启系统使其生效

# 2. 系统资源

## 2.1 CPU

### 2.1.1 查看CPU使用负载

```bash
[root@localhost appgess]# uptime
 10:36:22 up  1:16,  1 user,  load average: 0.00, 0.01, 0.05
[root@localhost appgess]#
```

| 参数                           | 说明                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| 10:36:22                       | 当前时间                                                     |
| up    1:16                     | 系统运行了多长时间了                                         |
| 1 user                         | 当前登录用户数量                                             |
| load average: 0.00, 0.01, 0.05 | 系统负载, 1: 表示前1分钟到现在, 2: 表示前5分钟到现在, 10: 表示前十分钟到现在 |

* 系统负载表示: 

  表示全部CPU的负载值

  单核: 1.00表示刚好CPU负载为100%, 2.00表示已经超过了CPU的2倍, 依次类推

  双核: 2.00表示刚好CPU负载为100%, 4.00表示已经超过了CPU的2倍, 依次类推

  4 核:  4.00表示刚好CPU负载为100%, 8.00表示已经超过了CPU的2倍, 依次类推

### 2.1.1 CPU使用率排序

#### 2.1.1.1 CPU使用率排序

```bash
top 按P
```

* -P按照CPU使用率排序

#### 2.1.1.2 实际使用CPU排序

```bash
ps -aux --sort -pcpu | head -n 10
```

* -pcpu: 显示进程绝对路径

## 2.2 内存

### 2.2.1 内存使用率排序

```bash
top 按M
```

* M: 按照内存使用率排序

### 2.2.2 实际使用内存排序

```bash
ps aux --sort -rss | head -n 10
```

* -rss: 按照内存使用排序

## 3.3 磁盘IO

命令安装

```bash
yum install sysstat iotop -y
```

### 3.3.1 磁盘IO检测

#### 3.3.11 参数介绍

```bash
iostat [选项] device
```

* -p: 指定device|ALL, 系统分区信息
* -k: 以K为单位显示磁盘IO信息
* -d: 仅显示磁盘统计信息

#### 3.3.1.2 实例

```bash
[root@localhost appgess]# iostat -p -kd /dev/sda
Linux 3.10.0-1127.el7.x86_64 (localhost.localdomain) 	07/26/2020 	_x86_64_	(4 CPU)

Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn
sda               0.28        11.83         4.40     643428     239367
sda1              0.00         0.11         0.04       6244       2068
sda2              0.28        11.69         4.36     635640     237299
[root@localhost appgess]#
```

* KB_read/s: 每秒读取量, 单位K
* kB_wrtn/s: 每秒写入量, 单位K
* kB_read: 读取总量: 单位K
* kB_wrtn: 写入总量: 单位K

生成测试数据:

```bash
dd if=/dev/zero of=test.txt bs=10M count=1000; sync  # 直接向磁盘写入数据, 并不读取
```

* if: 读取文件
* of: 写入文件
* bs: 设置读取/输出块大小, bytes
* count: 指定读取字节, bytes
* sync: 将内存信息快速写入到磁盘, 不进行缓存

### 3.3.2 进程占用磁盘IO

#### 3.3.2.1 参数介绍

类似top命令

```bash
iotop [选项] [参数]
```

* -o: 只显示读写磁盘的程序
* -d: 设置刷新时间

#### 3.3.2.2 实例

```bash
iotop -od 1  # 一秒刷新一次检测磁盘io信息
```



## 3.4 网络流量

监控程序安装

```bash
wget http://www.roland-riegel.de/nload/nload-0.7.4.tar.gz
tar -zxf nload-0.7.4.tar.gz
cd !$
./configure
make -j4
make install
```

### 3.4.1 网卡流量统计

```bash
[root@localhost appgess]# nload
Device docker0 [172.17.0.1] (1/3):
=========================================================================================
Incoming:  # 下载




                                                             Curr: 0.00 Bit/s  # 当前下载
                                                             Avg: 0.00 Bit/s  # 平均
                                                             Min: 0.00 Bit/s  # 最小
                                                             Max: 0.00 Bit/s  # 最大
                                                             Ttl: 0.00 Byte  # 生存统计
Outgoing: # 上传





                                                             Curr: 0.00 Bit/s
                                                             Avg: 0.00 Bit/s
                                                             Min: 0.00 Bit/s
                                                             Max: 0.00 Bit/s
                                                             Ttl: 0.00 Byte
```

### 3.4.2 进程流量统计

#### 3.4.2.1 程序安装

下载: [nethogs](./image/nethogs-0.8.5-1.el7.x86_64.rpm)

```bash
rpm -ivh nethogs-0.8.5-1.el7.x86_64.rpm
```

#### 3.4.2.2 实例

```bash
[root@localhost appgess]# nethogs
NetHogs version 0.8.5

    PID USER     PROGRAM                             DEV        SENT      RECEIVED       
   2348 appgess  sshd: appgess@pts/0                 eth0        0.182       0.059 KB/sec
      ? root     unknown TCP                                     0.000       0.000 KB/sec

  TOTAL                                                          0.182       0.059 KB/sec
```